SliTaz Secure File Storage
===============================================================================


Ssfs is personal, secure, fast and light online file storage powered by
SSH, Rsync, Lsyncd and SHell script. It monitors a local folder and automatically
synchronizes the remote server. When files are transferred they are compressed and
encrypted with SSH. Connections to the remote host are automated with a RSA key,
and for each client the key must be sent to the server via a SSH password login.

Using ssfs lets you have a live synchronized and secure folder between many
computers with an online copy on a secure Linux server. But even without any
connections you have access to your files. Connections to the remote server
can also be done using the command line and 'ssh' from any clients such as
BSD, Android, OSX or Windows via Putty.

Ssfs is very easy to install, setup and configure to make your own secure online
file storage. It provides a cmdline tool for the client and the server with a
built in help. This README is also a howto in itself.

On the server side admin can choose by creating standard accounts or chrooted
accounts which enforce server security by restricting available commands in a
minimal chroot environment. User $HOME should be set to 0700 so users can't see
other users files.


Overview
--------

    * Online live sync with encrypted data
    * Drop files in a folder and they will be sync
    * Even without connection you have your data
    * Fast and light using stable and mature GNU tools
    * Easy to setup on the client and server side
    * Virtual disk for storage with minimal chroot
    * Easy to backup, update and maintain vdisk


Quick start guide
-----------------

    * Install ssfs on server and clients if not yet done
    * Create a vdisk on server # ssfs-server gen-vdisk
    * Check if chroot works (exit to quit) # ssfs-server chroot
    * Add a chrooted user to the Ssfs virtual disk so it can sync
      files or connect via SSH from a client:
      # ssfs-server adduser --login=demo --id=2000 --pass=demo
    * On the client side: ssfs-box setup or from the cmdline:
      $ ssfs setup --login=demo --host="server name or ip"
    * On client you can start ssfs on user login via the WM
      autostart script and or the command $ ssfs sync


Installation
------------
To work you need a SSH client, 'rsync' and 'lsyncd' installed. On SliTaz you
can simply install ssfs and it's dependencies or 'make install' from the
source directory (see the Development section). 


Client help and setup
---------------------
The cmdline interface ssfs lets you setup a client and start the daemon and
synchronize live with your system session via the Window Manager autostart
script or your personal ~/.profile file. To get a list of commands with
a short description:

$ ssfs help

To setup a client by creating a Lua configuration file and sending the RSA key
to the server, you can use the command 'setup'. Setup needs a login name and
server name or IP address and it will also create a secure RSA if none exists:

$ ssfs setup --login=user --host=server


GUI & Web interface
-------------------
Actually there is a small GTK/Yad but no web interface. The tool ssfs-box will
display info if a configuration file exists or start the setup box. Ther is no
plan for a users files web interface since security if more important, actually
user home have 0700 mode as so standard web server running user www can't see
the files. We may implemnt a HTTP Public dir wich coul handle xHTML pages, a
wiki, etc. Actually they is some work on a Ssfs server web interface with the
goal to provide service status an information.


Get configs on boot
-------------------
Ssfs can be used in a boot scripts to connect to a remote host and retrieve data
before a user session is started. It can be useful to provide persistent data for
Live systems and web boot.


Quota management
----------------
Actually the quota storage is based on a shared idea, the vdisk have a size and
all users share the space. For a pay service the vdisk can grow follwing the
users donations or monthly subscription.


Server setup
------------
On the server you must have a SSH server running and an user account with a
~/Sync folder in user home. You can have both, staandard accounts or chrooted
accounts, for a hosted service it is recommended to use a chroot and Ssfs
virtual disk. The vdisk can be any size you want and have a minimal chroot
environment that is under 3Mb.

If you want to create a vdisk and chroot automaticaly you can use use the tool
ssfs-server. Here is a short example to create a chroot and create a user
login 'tux-sync' with a protected $HOME in the chroot, the root directory can
be specified on the command line or changed in the configuration file. The
vdisk creation size is set in Gb and can be changed in config file or from
the cmdline:

# ssfs-server gen-vdisk --size=2
# ssfs-server adduser --login=tux-sync --id=2000 --pass=tuX0cc

Users can be listed or completely deleted including all files in home. More
information can be found with: ssfs-server usage


Ssfs virtual disk
-----------------
A virtual Ssfs disk is a raw file created with dd and formated in ext3. It is
mounted by default on /ssfs and contain a minimal chroot environemt with users
home directory. We use a virtual disk to enforce securiry and use a separate
media for Ssfs secure files, it also protect the host and limit storage size.
The tool ssfs-server handle vdisk creation but you can also create one manually
or use a separate HD if the server have more than one disk. To create 2Gb
vdisk and format it to ext3:

# dd if=/dev/zero of=/home/ssfs.disk bs=1G count=2
# mkfs.ext3 -T ext3 -L "Ssfs" -F /home/ssfs.ext3

Now you have a virtual disk you can mount it, the path must match SSFS_CHROOT
found in ssfs-server.conf, default mount point is /ssfs to clearly separate
the filesystem from the standard host file hierarchy:

# mkdir /ssfs
# mount -o loop -t ext3 /home/ssfs.disk /ssfs

To automaticaly mount the vdisk on boot you may want to add a ssfs system user
and a line into the file /etc/fstab:

# adduser -S -g "Ssfs Server" -h /ssfs -s /bin/false ssfs
/home/ssfs.disk    /ssfs ext3    rw,loop,ssfs,ssfs  0 0


Server users config
-------------------
When adding a user with 'ssfs-server adduser', the user is added to the host
/etc/passwd and a custom user config file is created in SSFS_USERS with the
login name.


Development and Bugs
--------------------
If you want to install the latest code to test and help in development you can
clone the ssfs Mercurial repository. As usual, closely follow the SliTaz light 
philosophy with speed and security in mind:

$ hg clone http://hg.slitaz.org/ssfs

Install with 'make install' (DESTDIR is supported for packaging), update the POT
file if any new strings have been added with 'make pot', and merger PO files with
the command 'make msgmerge'. Any ideas are welcome and can be discussed. If you
are searching for something to do you can have a look to the TODO file :-)

Bugs can be reported on the SliTaz mailing list, forum or scn since the devel
forum is synced. All sites are liked from the main website at:

http://www.slitaz.org/


===============================================================================

